#define T 64 /* number of samples */
#define N 2   /* number of source signals */
#define EPSILON 0.02//0.000001 - to get my piecewise rsqrt to work, had to crank up epsilon

#define DBL2HEX(a) (*(unsigned *)&a) /* (taken from LegUp examples) */
#define fabs(a) ((a) > 0.0 ? (a) : -(a)) /* floating absolute value (taken from LegUp examples) */

int iteration = 0;

/* mixing matrix */
float A[N][N] = {
  {0.2217, 1.3092},
  {-0.8861, 0.5211}
};

/* "randomly initialized" unmixing vector */
float w_next[N] = 
{
  -1.6161,
    0.0147
};
float w[N] = 
{
  -0.0378,
  0.4038
};

/* observations */ 
float mixed_signals[N][T];

/* intermediate variables */
float product_1[T];
float product_2[N];
float product_3[N];
float sum_1;

float whitened_signals[N][T] = {
	{0.04827997386281094,1.121369186961699,1.19620743487756,0.1900499735458042,-0.9812720730822376,-1.246695467829229,-0.3657027280605793,0.8497498220430494,1.281157745491227,0.5314115927072246,-0.7103644347774429,-1.30254493902242,-0.7006918995321171,0.5418437706466516,1.282622751612864,0.8403873108369219,-0.3787483212030456,-1.254939434513291,-0.9845956224222662,0.1802186985548135,1.162733762863976,1.050404345615526,-0.06743320907097115,-1.050730806947085,-1.147574054400504,-0.1566123146964027,0.9971299546704645,1.243682026135062,0.350520211561864,-0.8646981981903691,-1.286682663605807,-0.5284855810343411,0.7123351541147713,1.294785726576871,0.6833060111532503,-0.5599223659057296,-1.291890972300379,-0.8396890019431257,0.38074218534924,1.246868789988854,0.9613550382457657,-0.215274705385103,-1.204744043348702,-1.103184280157048,-0.01319439958592314,1.049155124848447,1.219458441298616,0.1890145828484994,-0.9824777175365217,-1.231892645561012,-0.3391446724993453,0.8691329816696893,1.278543851527881,0.5107018092790246,-0.72946568029006,-1.302229340893006,-0.6811818581129826,0.5626308215037739,1.28564305232675,0.82311071955211,-0.399773838129772,-1.258885151713818,-0.9648352357837157,0.2110048052632903},
	{0.03415998941718632,0.4454815550085303,0.4705325892551958,0.07659228119927206,-0.3805651408725979,-0.4846940670125543,-0.1424997657889586,0.3300325973534607,0.4977478715510134,0.2061192337590728,-0.2768626350093261,-0.5071865780760179,-0.2731007783499553,0.2101704054715097,0.4982695296196795,0.3261882443314035,-0.148192883698795,-0.4894411084658023,-0.3851876888752784,0.06627633884423541,0.4458142140249051,0.3980678903630483,-0.04275388796036649,-0.3932914140381447,-0.437005668789255,-0.05563577112370612,0.3904995482218994,0.4848128599084868,0.1365301245039801,-0.3365800402951346,-0.5009156338414904,-0.2060983446861791,0.2764879977349832,0.5030243921024169,0.265194176078318,-0.2183496005061776,-0.5030459734068468,-0.3271865564058998,0.14741296986474,0.4840778162736886,0.3725688002568524,-0.08596650611969192,-0.4723937798635485,-0.4354963832108418,-0.01561028667417053,0.3915341633943046,0.4896804341148938,0.08284973100355322,-0.3768494768246288,-0.476460863304226,-0.1308148532785043,0.3382403900475834,0.4970167160728237,0.1981625998745257,-0.2842679377361577,-0.5070606587283881,-0.2655123065416893,0.2182585316982929,0.4994682243660596,0.3195669229166227,-0.1560850918372579,-0.4903068947710235,-0.3761466750161953,0.08072611247627257}
};

